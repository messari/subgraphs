# PoolTogether v4 Subgraph Methodology v1.0.0
(Ethereum, Polygon, Avalanche)
Briefly, PoolTogetherv4 is a lottery where users deposit their funds into a prize pool, 
the funds in said prize pool are put into protocols like Compound and Aave to generate yield, 
and then the yield (+ some protocol treasury) is distributed as prizes to the users. Users also get their original deposits back.

## Calculation Methodology v1.0.0

### Total Value Locked USD

On PoolTogetherv4, the total value locked is equal to the amount of deposits currently in the prize pool + DAO treasury incentives + the yield earned on these two. There is a new prize pool every 24 hours generated by the execution of a Prize Pool Instance (also known as a Draw), after which users are able to claim their winnings.

`TVL_Eth = (Deposits (USDC) since last Prize Pool Instance +  Pool Yield Earned) on Ethereum`
`TVL_Avax = (Deposits (USDC) since last Prize Pool Instance + Pool Yield Earned) on Avax`
`TVL_Matic = (Deposits (USDC) since last Prize Pool Instance + Pool Yield Earned) on Polygon`

`TVL = TVL_Eth + TVL_Avax + TVL_Matic`

### Protocol Controlled Value USD

This is not applicable to PoolTogether.

### Total Revenue USD

Total Revenue is the yield generated on the Deposits into the Prize Pool across Ethereum, Polygon, and Avalanche.

`Total Revenue = Pool Yield Earned on Ethereum, Avalanche, and Polygon`

### Supply Side Revenue USD

`Supply Side Revenue = Total Revenue`


### Protocol Revenue USD

PoolTogether does not have any Protocol Revenue at this time.

## Pool-Level Metrics

### Pool Total Value Locked USD

There are no Pools outside of the Prize Pools in PoolTogether, so

Pool Total Value Locked = Total Value Locked 

### Reward Tokens & Reward Token Emissions Amount

The V4 Design requires that prize liquidity reserves are maintained to fulfill all prizes that are awarded. Prize distributions are targeted to specific amounts, but do have variance. Similarly Aave yields vary. However this treasury is not held in the POOL token, so itâ€™s not relevant, but for completeness:
A ~6k USDC per day burn of the treasury subsidy was seen up until at least March 22nd, 2022, after which a PTIP was passed to reduce this to ~2K USDC per day. More details can be found here: https://gov.pooltogether.com/t/rfc-prize-liquidity/2102
And here: https://gov.pooltogether.com/t/prize-adjustment-3/2097

## Links 
Protocol
https://app.pooltogether.com/deposit

Docs
https://v4.docs.pooltogether.com/

Smart Contracts
https://v4.docs.pooltogether.com/protocol/contracts/

Messari Reports (a bit dated)
https://messari.io/article/how-pooltogether-is-building-a-sustainable-lottery-at-the-protocol-level (Oct, 2020)
https://messari.io/article/pooltogether-launches-new-no-loss-protocol (Oct, 2020)

Dune Dashboards 
https://dune.com/sarfang/PoolTogetherV4
