# Subgraph Schema: Generic
# Version: 1.4.0
# See https://github.com/messari/subgraphs/blob/master/docs/SCHEMA.md for details

enum Network {
  ARBITRUM_ONE
  ARWEAVE_MAINNET
  AURORA
  AVALANCHE
  BOBA
  BSC # aka BNB Chain
  CELO
  COSMOS
  CRONOS
  MAINNET # Ethereum Mainnet
  FANTOM
  FUSE
  HARMONY
  JUNO
  MOONBEAM
  MOONRIVER
  NEAR_MAINNET
  OPTIMISM
  OSMOSIS
  MATIC # aka Polygon
  XDAI # aka Gnosis Chain
}

enum ProtocolType {
  EXCHANGE
  LENDING
  YIELD
  BRIDGE
  GENERIC
  # Will add more
}

type Token @entity @regularPolling {
  " Smart contract address of the token "
  id: ID!

  " Name of the token, mirrored from the smart contract "
  name: String!

  " Symbol of the token, mirrored from the smart contract "
  symbol: String!

  " The number of decimal places this token uses, default to 18 "
  decimals: Int!

  " Optional field to track the price of a token, mostly for caching purposes "
  lastPriceUSD: BigDecimal

  " Optional field to track the block number of the last token price "
  lastPriceBlockNumber: BigInt
}

enum RewardTokenType {
  " For reward tokens awarded to LPs/lenders "
  DEPOSIT

  " For reward tokens awarded to borrowers "
  BORROW
}

type RewardToken @entity @regularPolling {
  " { Reward token type }-{ Smart contract address of the reward token } "
  id: ID!

  " Reference to the actual token "
  token: Token!

  " The type of the reward token "
  type: RewardTokenType!
}

#############################
##### Protocol Metadata #####
#############################

type Protocol @entity @regularPolling {
  " Smart contract address of the protocol's main contract (Factory, Registry, etc) "
  id: ID!

  " Name of the protocol, including version. e.g. Uniswap v3 "
  name: String!

  " Slug of protocol, including version. e.g. uniswap-v3 "
  slug: String!

  " Version of the subgraph schema, in SemVer format (e.g. 1.0.0) "
  schemaVersion: String!

  " Version of the subgraph implementation, in SemVer format (e.g. 1.0.0) "
  subgraphVersion: String!

  " Version of the methodology used to compute metrics, loosely based on SemVer format (e.g. 1.0.0) "
  methodologyVersion: String!

  " The blockchain network this subgraph is indexing on "
  network: Network!

  " The type of protocol (e.g. DEX, Lending, Yield, etc) "
  type: ProtocolType!

  ##### Quantitative Data #####

  " Current TVL (Total Value Locked) of the entire protocol "
  totalValueLockedUSD: BigDecimal!

  " Current PCV (Protocol Controlled Value). Only relevant for protocols with PCV. "
  protocolControlledValueUSD: BigDecimal

  " Revenue claimed by suppliers to the protocol. LPs on DEXs (e.g. 0.25% of the swap fee in Sushiswap). Depositors on Lending Protocols. NFT sellers on OpenSea. "
  cumulativeSupplySideRevenueUSD: BigDecimal!

  " Gross revenue for the protocol (revenue claimed by protocol). Examples: AMM protocol fee (Sushi’s 0.05%). OpenSea 10% sell fee. "
  cumulativeProtocolSideRevenueUSD: BigDecimal!

  " All revenue generated by the protocol. e.g. 0.30% of swap fee in Sushiswap, all yield generated by Yearn. "
  cumulativeTotalRevenueUSD: BigDecimal!

  " Number of cumulative unique users "
  cumulativeUniqueUsers: Int!

  " Total number of pools "
  totalPoolCount: Int!

  ##### Snapshots #####

  " Daily usage metrics for this protocol "
  dailyUsageMetrics: [UsageMetricsDailySnapshot!]!
    @derivedFrom(field: "protocol")

  " Hourly usage metrics for this protocol "
  hourlyUsageMetrics: [UsageMetricsHourlySnapshot!]!
    @derivedFrom(field: "protocol")

  " Daily financial metrics for this protocol "
  financialMetrics: [FinancialsDailySnapshot!]! @derivedFrom(field: "protocol")

  ##### Pools #####

  " All pools that belong to this protocol "
  pools: [Pool!]! @derivedFrom(field: "protocol")
}

###############################
##### Protocol Timeseries #####
###############################

type UsageMetricsDailySnapshot @entity @dailySnapshot {
  " ID is # of days since Unix epoch time "
  id: ID!

  " Protocol this snapshot is associated with "
  protocol: Protocol!

  " Number of unique daily active users "
  dailyActiveUsers: Int!

  " Number of cumulative unique users "
  cumulativeUniqueUsers: Int!

  " Total number of transactions occurred in a day. Transactions include all entities that implement the Event interface. "
  dailyTransactionCount: Int!

  " Total number of pools "
  totalPoolCount: Int!

  " Block number of this snapshot "
  blockNumber: BigInt!

  " Timestamp of this snapshot "
  timestamp: BigInt!
}

type UsageMetricsHourlySnapshot @entity @hourlySnapshot {
  " { # of hours since Unix epoch time } "
  id: ID!

  " Protocol this snapshot is associated with "
  protocol: Protocol!

  " Number of unique hourly active users "
  hourlyActiveUsers: Int!

  " Number of cumulative unique users "
  cumulativeUniqueUsers: Int!

  " Total number of transactions occurred in an hour. Transactions include all entities that implement the Event interface. "
  hourlyTransactionCount: Int!

  " Block number of this snapshot "
  blockNumber: BigInt!

  " Timestamp of this snapshot "
  timestamp: BigInt!
}

type FinancialsDailySnapshot @entity @dailySnapshot {
  " ID is # of days since Unix epoch time "
  id: ID!

  " Protocol this snapshot is associated with "
  protocol: Protocol!

  " Current TVL (Total Value Locked) of the entire protocol "
  totalValueLockedUSD: BigDecimal!

  " Current PCV (Protocol Controlled Value). Only relevant for protocols with PCV. "
  protocolControlledValueUSD: BigDecimal

  " Revenue claimed by suppliers to the protocol. LPs on DEXs (e.g. 0.25% of the swap fee in Sushiswap). Depositors on Lending Protocols. NFT sellers on OpenSea. "
  dailySupplySideRevenueUSD: BigDecimal!

  " Revenue claimed by suppliers to the protocol. LPs on DEXs (e.g. 0.25% of the swap fee in Sushiswap). Depositors on Lending Protocols. NFT sellers on OpenSea. "
  cumulativeSupplySideRevenueUSD: BigDecimal!

  " Gross revenue for the protocol (revenue claimed by protocol). Examples: AMM protocol fee (Sushi’s 0.05%). OpenSea 10% sell fee. "
  dailyProtocolSideRevenueUSD: BigDecimal!

  " Gross revenue for the protocol (revenue claimed by protocol). Examples: AMM protocol fee (Sushi’s 0.05%). OpenSea 10% sell fee. "
  cumulativeProtocolSideRevenueUSD: BigDecimal!

  " All revenue generated by the protocol. e.g. 0.30% of swap fee in Sushiswap, all yield generated by Yearn. "
  dailyTotalRevenueUSD: BigDecimal!

  " All revenue generated by the protocol. e.g. 0.30% of swap fee in Sushiswap, all yield generated by Yearn. "
  cumulativeTotalRevenueUSD: BigDecimal!

  " Block number of this snapshot "
  blockNumber: BigInt!

  " Timestamp of this snapshot "
  timestamp: BigInt!
}

###########################
##### Pool-Level Data #####
###########################

type Pool @entity @regularPolling {
  " Smart contract address of the pool "
  id: ID!

  " The protocol this pool belongs to "
  protocol: Protocol!

  " Name of the pool (e.g. Curve.fi DAI/USDC/USDT) "
  name: String

  " Symbol of liquidity pool (e.g. 3CRV) "
  symbol: String

  # Generally protocols accept one or multiple tokens and mint tokens to the depositor to track ownership
  # Some protocols don't mint any tokens to track ownership, in that case outputToken is null.

  " Tokens that need to be deposited to take a position in protocol. e.g. WETH and USDC to deposit into the WETH-USDC pool. Array to account for multi-asset pools like Curve and Balancer "
  inputTokens: [Token!]!

  " Token that is minted to track ownership of position in protocol "
  outputToken: Token

  " Aditional tokens that are given as reward for position in a protocol, usually in liquidity mining programs. e.g. SUSHI in the Onsen program, MATIC for Aave Polygon, usually in liquidity mining programs. e.g. SUSHI in the Onsen program, MATIC for Aave Polygon "
  rewardTokens: [RewardToken!]

  " Creation timestamp "
  createdTimestamp: BigInt!

  " Creation block number "
  createdBlockNumber: BigInt!

  ##### Quantitative Data #####

  " Current TVL (Total Value Locked) of this pool in USD "
  totalValueLockedUSD: BigDecimal!

  " All revenue generated by the pool, accrued to the supply side. "
  cumulativeSupplySideRevenueUSD: BigDecimal!

  " All revenue generated by the pool, accrued to the protocol. "
  cumulativeProtocolSideRevenueUSD: BigDecimal!

  " All revenue generated by the pool. "
  cumulativeTotalRevenueUSD: BigDecimal!

  " Amount of input tokens in the pool. The ordering should be the same as the pool's `inputTokens` field. "
  inputTokenBalances: [BigInt!]!

  " The USD value of input tokens in this pool. Should be the same order as the pool's `inputTokens` field. "
  inputTokenBalancesUSD: [BigDecimal!]!

  " Total supply of output token. Note that certain DEXes don't have an output token (e.g. Bancor) "
  outputTokenSupply: BigInt

  " Price per share of output token in USD "
  outputTokenPriceUSD: BigDecimal

  " Total supply of output tokens that are staked (usually in the MasterChef contract). Used to calculate reward APY. "
  stakedOutputTokenAmount: BigInt

  " Per-block reward token emission as of the current block normalized to a day, in token's native amount. This should be ideally calculated as the theoretical rate instead of the realized amount. "
  rewardTokenEmissionsAmount: [BigInt!]

  " Per-block reward token emission as of the current block normalized to a day, in USD value. This should be ideally calculated as the theoretical rate instead of the realized amount. "
  rewardTokenEmissionsUSD: [BigDecimal!]

  ##### Snapshots #####

  " Pool daily snapshots "
  dailySnapshots: [PoolDailySnapshot!]! @derivedFrom(field: "pool")

  " Pool hourly snapshots "
  hourlySnapshots: [PoolHourlySnapshot!]! @derivedFrom(field: "pool")
}

type PoolDailySnapshot @entity @dailySnapshot {
  " { Smart contract address of the pool }-{ # of days since Unix epoch time } "
  id: ID!

  " The protocol this snapshot belongs to "
  protocol: Protocol!

  " The pool this snapshot belongs to "
  pool: Pool!

  " Block number of this snapshot "
  blockNumber: BigInt!

  " Timestamp of this snapshot "
  timestamp: BigInt!

  ##### Quantitative Data #####

  " Current TVL (Total Value Locked) of this pool "
  totalValueLockedUSD: BigDecimal!

  " All revenue generated by the pool, accrued to the supply side. "
  cumulativeSupplySideRevenueUSD: BigDecimal!

  " Daily revenue generated by the pool, accrued to the supply side. "
  dailySupplySideRevenueUSD: BigDecimal!

  " All revenue generated by the pool, accrued to the protocol. "
  cumulativeProtocolSideRevenueUSD: BigDecimal!

  " Daily revenue generated by the pool, accrued to the protocol. "
  dailyProtocolSideRevenueUSD: BigDecimal!

  " All revenue generated by the pool. "
  cumulativeTotalRevenueUSD: BigDecimal!

  " Daily revenue generated by the pool. "
  dailyTotalRevenueUSD: BigDecimal!

  " Amount of input tokens in the pool. The ordering should be the same as the pool's `inputTokens` field. "
  inputTokenBalances: [BigInt!]!

  " The USD value of input tokens in this pool. Should be the same order as the pool's `inputTokens` field. "
  inputTokenBalancesUSD: [BigDecimal!]!

  " Total supply of output token. Note that certain DEXes don't have an output token (e.g. Bancor) "
  outputTokenSupply: BigInt

  " Price per share of output token in USD "
  outputTokenPriceUSD: BigDecimal

  " Total supply of output tokens that are staked (usually in the MasterChef contract). Used to calculate reward APY. "
  stakedOutputTokenAmount: BigInt

  " Per-block reward token emission as of the current block normalized to a day, in token's native amount. This should be ideally calculated as the theoretical rate instead of the realized amount. "
  rewardTokenEmissionsAmount: [BigInt!]

  " Per-block reward token emission as of the current block normalized to a day, in USD value. This should be ideally calculated as the theoretical rate instead of the realized amount. "
  rewardTokenEmissionsUSD: [BigDecimal!]
}

type PoolHourlySnapshot @entity @hourlySnapshot {
  " { Smart contract address of the pool }-{ # of hours since Unix epoch time } "
  id: ID!

  " The protocol this snapshot belongs to "
  protocol: Protocol!

  " The pool this snapshot belongs to "
  pool: Pool!

  " Block number of this snapshot "
  blockNumber: BigInt!

  " Timestamp of this snapshot "
  timestamp: BigInt!

  ##### Quantitative Data #####

  " Current TVL (Total Value Locked) of this pool "
  totalValueLockedUSD: BigDecimal!

  " All revenue generated by the pool, accrued to the supply side. "
  cumulativeSupplySideRevenueUSD: BigDecimal!

  " Hourly revenue generated by the pool, accrued to the supply side. "
  hourlySupplySideRevenueUSD: BigDecimal!

  " All revenue generated by the pool, accrued to the protocol. "
  cumulativeProtocolSideRevenueUSD: BigDecimal!

  " Hourly revenue generated by the pool, accrued to the protocol. "
  hourlyProtocolSideRevenueUSD: BigDecimal!

  " All revenue generated by the pool. "
  cumulativeTotalRevenueUSD: BigDecimal!

  " Hourly revenue generated by the pool. "
  hourlyTotalRevenueUSD: BigDecimal!

  " Amount of input tokens in the pool. The ordering should be the same as the pool's `inputTokens` field. "
  inputTokenBalances: [BigInt!]!

  " The USD value of input tokens in this pool. Should be the same order as the pool's `inputTokens` field. "
  inputTokenBalancesUSD: [BigDecimal!]!

  " Total supply of output token. Note that certain DEXes don't have an output token (e.g. Bancor) "
  outputTokenSupply: BigInt

  " Price per share of output token in USD "
  outputTokenPriceUSD: BigDecimal

  " Total supply of output tokens that are staked (usually in the MasterChef contract). Used to calculate reward APY. "
  stakedOutputTokenAmount: BigInt

  " Per-block reward token emission as of the current block normalized to a day (not hour), in token's native amount. This should be ideally calculated as the theoretical rate instead of the realized amount. "
  rewardTokenEmissionsAmount: [BigInt!]

  " Per-block reward token emission as of the current block normalized to a day (not hour), in USD value. This should be ideally calculated as the theoretical rate instead of the realized amount. "
  rewardTokenEmissionsUSD: [BigDecimal!]
}

###################
##### Add Ons #####
###################

# An account is a unique Ethereum address
# Helps to accumulate total unique users
type Account @entity @regularPolling {
  " Address of the account "
  id: ID!
}

# Helper entity for calculating daily/hourly active users
type ActiveAccount @entity @regularPolling {
  " { daily/hourly }-{ Address of the account }-{ Days/hours since Unix epoch } "
  id: ID!
}

# Entity that represents the RocketPool protocol.
type RocketPoolProtocol @entity @regularPolling {
  # The name of the RocketPool protocol.
  id: ID!

  # All stakers that have had ETH rewards while staking with RocketPool.
  stakersWithETHRewards: [Staker!]!

  # All stakers that currently have an rETH balance greater than 0.
  activeStakers: [Staker!]!

  # All stakers that have ever held rETH.
  stakers: [Staker!]!

  # Last known staker network balance checkpoint.
  lastNetworkStakerBalanceCheckPoint: NetworkStakerBalanceCheckpoint

  # All nodes that are registered with the RocketPool protocol.
  nodes: [Node!]!

  # All timezones associated with registered nodes.
  nodeTimezones: [NetworkNodeTimezone!]!

  # Last known RPL reward interval.
  lastRPLRewardInterval: RPLRewardInterval

  # Last known node network balance checkpoint.
  lastNetworkNodeBalanceCheckPoint: NetworkNodeBalanceCheckpoint

  # All node network balance checkpoints for the RocketPool protocol.
  networkNodeBalanceCheckpoints: [NetworkNodeBalanceCheckpoint!]!
}

# An address that is/was associated with an rETH balance.
type Staker @entity {
  # Address that holds rETH.
  id: ID!

  # Current rETH balance in WEI.
  rETHBalance: BigInt!

  # Current ETH balance in WEI.
  ethBalance: BigInt!

  # Total ETH rewards (in WEI) accrued during the lifecycle of the staker.
  totalETHRewards: BigInt!

  # Indicates if this staker has accrued ETH rewards at some point in time during its lifetime.
  hasAccruedETHRewardsDuringLifecycle: Boolean!

  # The last known staker balance checkpoint for this staker.
  lastBalanceCheckpoint: StakerBalanceCheckpoint

  # Block number at which this staker first received rETH.
  block: BigInt!

  # Block timestamp at which this staker first received rETH.
  blockTime: BigInt!
}

# Tracks the mint, burn and transfers of rETH.
type RocketETHTransaction @entity(immutable: true) {
  # Composite key based on transaction hash of the triggered event and its log index.
  id: ID!

  # The address that was the original owner of the rETH.
  from: Staker!

  # The rETH amount (in WEI) being transferred.
  amount: BigInt!

  # The address that was the recipient of the rETH.
  to: Staker!

  # The block number of this transaction.
  block: BigInt!

  # The block timestamp of this transaction.
  blockTime: BigInt!

  # The transaction hash.
  transactionHash: Bytes!
}

# Summarizes staker related balances at a specific block and timestamp.
type NetworkStakerBalanceCheckpoint @entity {
  # Composite key based on transaction hash of the triggered event and its log index.
  id: ID!

  # Id to the the previous checkpoint.
  previousCheckpointId: String

  # Id to the the next checkpoint.
  nextCheckpointId: String

  # Staker ETH (in WEI) balance (initial deposit + (ETH network rewards - average node fee)) on the beacon chain at this checkpoint.
  stakerETHActivelyStaking: BigInt!

  # Staker ETH (in WEI) waiting in the deposit pool at this checkpoint.
  stakerETHWaitingInDepositPool: BigInt!

  # Staker ETH (in WEI) in the RocketETH contract at this checkpoint.
  stakerETHInRocketETHContract: BigInt!

  # Staker ETH (in WEI) in RocketPool at this checkpoint.
  stakerETHInProtocol: BigInt!

  # Staker ETH rewards (+/-) (in WEI) for all staker balance checkpoints up to this checkpoint.
  totalStakerETHRewards: BigInt!

  # Stakers that have had ETH rewards (+/-) up to this checkpoint.
  totalStakersWithETHRewards: BigInt!

  # Average staker ETH rewards (+/-) (in WEI) up to this checkpoint.
  averageStakerETHRewards: BigInt!

  # Total unique stakers that have an rETH balance (in WEI) greater than 0 at this checkpoint.
  stakersWithAnRETHBalance: BigInt!

  # Total rETH supply at this checkpoint.
  totalRETHSupply: BigInt!

  # Exchange rate of ETH:rETH (in WEI) at this checkpoint.
  rETHExchangeRate: BigInt!

  # Block Number of this checkpoint.
  block: BigInt!

  # Block Timestamp of this checkpoint.
  blockTime: BigInt!
}

# Summarizes balances for a staker at a specific block and timestamp.
type StakerBalanceCheckpoint @entity {
  # Composite key consisting of the NetworkBalanceCheckpoint ID and the Staker ID.
  id: ID!

  # Staker that is associated with this balance checkpoint.
  stakerId: String!

  # The network staker balance checkpoint that triggered the creation of this reward.
  networkStakerBalanceCheckpointId: String!

  # ETH balance (in WEI) of the staker of this checkpoint.
  ethBalance: BigInt!

  # rETH balance (in WEI) of the staker of this checkpoint.
  rETHBalance: BigInt!

  # Total ETH rewards (in WEI) up to this checkpoint.
  totalETHRewards: BigInt!

  # Block Number of this checkpoint.
  block: BigInt!

  # Block Timestamp of this checkpoint.
  blockTime: BigInt!
}

# A node address that was registered by a node operator.
type Node @entity @regularPolling {
  # Address that is associated with a node on RocketPool.
  id: ID!

  # Current timezone for this node.
  timezone: NetworkNodeTimezone!

  # Indicator that determines if a node is currently an oracle node or not.
  isOracleNode: Boolean!

  # If this node is currently an oracle node, signifies the RPL bond of the ODAO node.
  oracleNodeRPLBond: BigInt

  # Identifies the block time of the last ODAO state change for this node.
  oracleNodeBlockTime: BigInt

  # Current RPL staked.
  rplStaked: BigInt!

  # Current effective RPL staked
  effectiveRPLStaked: BigInt!

  # Total RPL slashed since this node was registered with RocketPool.
  totalRPLSlashed: BigInt!

  # Total claim amount accrued via the ODAO reward claim contract.
  totalODAORewardsClaimed: BigInt!

  # Total claim amount accrued via the regular reward claim contract.
  totalNodeRewardsClaimed: BigInt!

  # Average reward claim this node has done via the ODAO reward claim contract.
  averageODAORewardClaim: BigInt!

  # Average reward claim this node has done via the regular reward claim contract.
  averageNodeRewardClaim: BigInt!

  # Total amount of successfull RPL claims a node has done via the ODAO reward claim contract.
  odaoRewardClaimCount: BigInt!

  # Total amount of successfull RPL claims a node has done via the regular node reward claim contract.
  nodeRewardClaimCount: BigInt!

  # Current minimum RPL needed to collateralize all staking minipools of this node by the bare minimum.
  minimumEffectiveRPL: BigInt!

  # Current maximum RPL needed to collateralize all staking minipools of this node to the absolute maximum.
  maximumEffectiveRPL: BigInt!

  # Current queueud minipools
  queuedMinipools: BigInt!

  # Current staking minipools
  stakingMinipools: BigInt!

  # Current unbonded staking minipools
  stakingUnbondedMinipools: BigInt!

  # Current withdrawable minipools.
  withdrawableMinipools: BigInt!

  # Finalized minipools since this node was registered with RocketPool.
  totalFinalizedMinipools: BigInt!

  # Average minipool fee for the active (NOT finalized or destroyed) minipools for this node operator.
  averageFeeForActiveMinipools: BigInt!

  # Last node balance checkpoint for this node.
  lastNodeBalanceCheckpoint: NodeBalanceCheckpoint

  # Associated minipools for this node.
  minipools: [Minipool!]!

  # Block number at which this node was first registered with the protocol.
  block: BigInt!

  # Block timestamp at which this node was first registered with the protocol.
  blockTime: BigInt!
}

# The type of RPL Stake transactions.
enum NodeRPLStakeTransactionType {
  Staked
  Withdrawal
  Slashed
}

# Keeps track of the RPL staking transactions for a node.
type NodeRPLStakeTransaction @entity {
  # Composite key based on transaction hash of the triggered event and its log index.
  id: ID!

  # Total number of nodes registered with this timezone.
  node: Node!

  # The total RPL amount that concerns this transaction.
  amount: BigInt!

  # The total ETH equivalent at the time of this transaction.
  ethAmount: BigInt!

  # The type of RPL stake transaction.
  type: NodeRPLStakeTransactionType!

  # On what block number did this transaction occur.
  block: BigInt!

  # At what time did this transaction occur.
  blockTime: BigInt!
}

# Represents an reward interval during which RPL can be claimed by different types of claimers.
type RPLRewardInterval @entity {
  # Composite key based on transaction hash of the triggered event and its log index.
  id: ID!

  # ID to the previous.
  previousIntervalId: String

  # ID to the next interval.
  nextIntervalId: String

  # The total RPL rewards that are claimable for this interval.
  claimableRewards: BigInt!

  # The total RPL rewards from the previous interval that rolled over into this interval.
  claimableRewardsFromPreviousInterval: BigInt!

  # The total RPL rewards that are claimable for this interval via the PDAO reward claim contract.
  claimablePDAORewards: BigInt!

  # The total RPL rewards that are claimable for this interval via the ODAO reward claim contract.
  claimableODAORewards: BigInt!

  # The total RPL rewards that are claimable for this interval via the regula node reward claim contract.
  claimableNodeRewards: BigInt!

  # The total RPL rewards claimed during this interval.
  totalRPLClaimed: BigInt!

  # The total RPL rewards that have been claimed during this interval for the PDAO reward claim contract.
  totalPDAORewardsClaimed: BigInt!

  # The total RPL rewards that have been claimed during this interval for the ODAO reward claim contract.
  totalODAORewardsClaimed: BigInt!

  # The total RPL rewards that have been claimed during this interval for the regular node reward claim contract.
  totalNodeRewardsClaimed: BigInt!

  # Average RPL claim for the ODAO reward claim contract during this interval.
  averageODAORewardClaim: BigInt!

  # Average RPL claim for the regular node reward claim contract during this interval.
  averageNodeRewardClaim: BigInt!

  # The total number of claims done for the ODAO reward claim contract during this interval.
  odaoRewardClaimCount: BigInt!

  # The total number of claims done for the regular node reward claim contract during this interval.
  nodeRewardClaimCount: BigInt!

  # The total RPL rewards that were given out in this interval.
  rplRewardClaims: [RPLRewardClaim!]!

  # Indicates if this interval is still active.
  isClosed: Boolean!

  # Indicates when this interval started.
  intervalStartTime: BigInt!

  # Indicates when this interval ended.
  intervalClosedTime: BigInt

  # Indicates how long the interval was supposed to last.
  intervalDuration: BigInt!

  # Indicates how long the interval actually lasted.
  intervalDurationActual: BigInt

  # On what block number was this interval created.
  block: BigInt!

  # At what time was this interval created.
  blockTime: BigInt!
}

# Represents an reward interval during which RPL can be claimed by different types of claimers.
type RPLRewardSubmitted @entity {
  # Reward Index
  id: ID!

  rewardIndex: BigInt!
  executionBlock: BigInt!
  consensusBlock: BigInt!
  merkleRoot: Bytes!
  merkleTreeCID: String!
  intervalsPassed: BigInt!
  treasuryRPL: BigInt!
  trustedNodeRPL: [BigInt!]!
  nodeRPL: [BigInt!]!
  nodeETH: [BigInt!]!
  userETH: BigInt!

  # On what block number was this interval created.
  block: BigInt!

  # At what time was this interval created.
  blockTime: BigInt!
}

# Represents the RPL reward claimer options.
enum RPLRewardClaimerType {
  PDAO
  ODAO
  Node
}

# Represents an RPL reward that has been claimed by an address.
type RPLRewardClaim @entity {
  # Composite key based on transaction hash of the triggered event and its log index.
  id: ID!

  # Id of the associated RPL reward interval parent.
  rplRewardIntervalId: String!

  # The claiming address.
  claimer: String!

  # The type of the claimer.
  claimerType: RPLRewardClaimerType!

  # The total RPL amount of this claim.
  amount: BigInt!

  # The total ETH equivalent (in WEI) at the time of this reward.
  ethAmount: BigInt!

  # The transaction hash associated with this claim.
  transactionHash: String!

  # The block number associated with this claim.
  block: BigInt!

  # The block timestamp associated with this claim.
  blockTime: BigInt!
}

# Represents the network timezones and the registered node(s).
type NetworkNodeTimezone @entity {
  # Timezone name.
  id: ID!

  # Total nodes registered with this timezone.
  totalRegisteredNodes: BigInt!

  # Block Number on which this timezone was created.
  block: BigInt!

  # Block Timestamp on which this timezone was created.
  blockTime: BigInt!
}

# Represents a network balance checkpoint for all nodes.
type NetworkNodeBalanceCheckpoint @entity {
  # Composite key based on transaction hash of the triggered event and its log index.
  id: ID!

  # Id to the the previous checkpoint.
  previousCheckpointId: String

  # Id to the the next checkpoint.
  nextCheckpointId: String

  # Total number of registered RocketPool nodes at this checkpoint.
  nodesRegistered: BigInt!

  # Total number of oracle nodes registrered with RocketPool at this checkpoint.
  oracleNodesRegistered: BigInt!

  # RPL staked accross all nodes at this checkpoint.
  rplStaked: BigInt!

  # Effective RPL staked accross all nodes at this checkpoint.
  effectiveRPLStaked: BigInt!

  # Minimum RPL needed to collateralize the staking minipools by the absolute minimum at this checkpoint.
  minimumEffectiveRPL: BigInt!

  # maximum RPL needed to collateralize the staking minipools to the absolute maximum at this checkpoint.
  maximumEffectiveRPL: BigInt!

  # Minimum RPL needed to start a new minipool at this checkpoint.
  minimumEffectiveRPLNewMinipool: BigInt!

  # Maximum RPL needed to start a new minipool at this checkpoint.
  maximumEffectiveRPLNewMinipool: BigInt!

  # Total RPL slashed from all previous checkpoints up to this checkpoint.
  totalRPLSlashed: BigInt!

  # Total accrued rewards via the ODAO reward claim contract from all previous checkpoints up to this checkpoint.
  totalODAORewardsClaimed: BigInt!

  # Total accrued rewards via the regular node reward claim contract from all previous checkpoints up to this checkpoint.
  totalNodeRewardsClaimed: BigInt!

  # Average total accrued rewards via the ODAO reward claim contract from all previous checkpoints up to this checkpoint.
  averageTotalODAORewardsClaimed: BigInt!

  # Average reward per claim via the ODAO reward claim contract from all previous checkpoints up to this checkpoint.
  averageODAORewardClaim: BigInt!

  # Average total accrued rewards via the regular node reward claim contract from all previous checkpoints up to this checkpoint.
  averageNodeTotalRewardsClaimed: BigInt!

  # Average reward per claim via the regular node reward claim contract from all previous checkpoints up to this checkpoint.
  averageNodeRewardClaim: BigInt!

  # The RPL price in ETH at this checkpoint.
  rplPriceInETH: BigInt!

  # The average RPL price in ETH up to this checkpoint.
  averageRplPriceInETH: BigInt!

  # Current queued minipools accross all nodes at this checkpoint.
  queuedMinipools: BigInt!

  # Current staking minipools accross all nodes at this checkpoint.
  stakingMinipools: BigInt!

  # Current unbonded staking minipools accross all nodes at this checkpoint.
  stakingUnbondedMinipools: BigInt!

  # Withdrawable minipools accross all nodes at this checkpoint.
  withdrawableMinipools: BigInt!

  # Total finalized minipools accross all nodes up to this checkpoint.
  totalFinalizedMinipools: BigInt!

  # Average minipool fee accross all nodes and the active (NOT finalized or destroyed) minipools at this checkpoint.
  averageFeeForActiveMinipools: BigInt!

  # Fee to start a new minipool at this checkpoint.
  newMinipoolFee: BigInt!

  # Block number that was associated with this checkpoint.
  block: BigInt!

  # Block timestamp that was associated with this checkpoint.
  blockTime: BigInt!
}

# Represents a balance checkpoint for a node.
type NodeBalanceCheckpoint @entity {
  # Composite key consisting of the NetworkNodeBalanceCheckpoint ID and the Node ID.
  id: ID!

  # Node that is associated with this checkpoint.
  Node: Node!

  # Network node balance checkpoint associated with this checkpoint.
  NetworkNodeBalanceCheckpoint: NetworkNodeBalanceCheckpoint!

  # Indicator that determines if a node is an oracle node or not at this checkpoint.
  isOracleNode: Boolean!

  # If this node is an oracle node at this checkpoint, signifies the RPL bond of the ODAO node.
  oracleNodeRPLBond: BigInt

  # Identifies the block time of the last ODAO state change for this node at this checkpoint.
  oracleNodeBlockTime: BigInt

  # RPL staked at this checkpoint.
  rplStaked: BigInt!

  # Effective RPL staked at this checkpoint.
  effectiveRPLStaked: BigInt!

  # Minimum RPL needed to collateralize the staking minipools by the bare minimum at this checkpoint.
  minimumEffectiveRPL: BigInt!

  # Maximum RPL needed to collateralize the staking minipools by the absolute maximum at this checkpoint.
  maximumEffectiveRPL: BigInt!

  # Total RPL slashed up to this checkpoint.
  totalRPLSlashed: BigInt!

  # Total accrued rewards via the ODAO reward claim contract up to this checkpoint.
  totalODAORewardsClaimed: BigInt!

  # Total accrued claimed rewards via the regular node reward claim contract up to this checkpoint.
  totalNodeRewardsClaimed: BigInt!

  # Average rewards accrued via the ODAO reward claim contract for this node up to this checkpoint.
  averageODAORewardClaim: BigInt!

  # Average rewards accrued via the regular node reward claim contract for this node up to this checkpoint.
  averageNodeRewardClaim: BigInt!

  # Total successfull claims a node has done via the ODAO reward claim contract up to this checkpoint.
  odaoRewardClaimCount: BigInt!

  # Total successfull claims a node has done via the regular node reward claim contract up to this checkpoint.
  nodeRewardClaimCount: BigInt!

  # Queued minipools for this node at this checkpoint.
  queuedMinipools: BigInt!

  # Staking minipools for this node at this checkpoint.
  stakingMinipools: BigInt!

  # Unbonded staking minipools for this node at this checkpoint.
  stakingUnbondedMinipools: BigInt!

  # Withdrawable minipools accross for this node at this checkpoint.
  withdrawableMinipools: BigInt!

  # Total Finalized minipools for this node up to this checkpoint.
  totalFinalizedMinipools: BigInt!

  # Average minipool fee for this node and the active (NOT finalized or destroyed) minipools at this checkpoint.
  averageFeeForActiveMinipools: BigInt!

  # Block number that was associated with this checkpoint.
  block: BigInt!

  # Block timestamp that was associated with this checkpoint.
  blockTime: BigInt!
}

# Represents a minipool for a node.
type Minipool @entity @regularPolling {
  # Address of the minipool.
  id: ID!

  # Node that is associated with this minipool.
  node: Node!

  # Fee that was assigned to this minipool when it was created.
  fee: BigInt!

  # Node deposit ETH amount (in WEI) that was assigned to this minipool when it was created.
  nodeDepositETHAmount: BigInt!

  # Block timestamp at which this minipool received a node deposit.
  nodeDepositBlockTime: BigInt!

  # User deposit ETH amount (in WEI) that was assigned to this minipool.
  userDepositETHAmount: BigInt!

  # Block timestamp at which this minipool received a user deposit.
  userDepositBlockTime: BigInt!

  # Block timestamp at which this minipool was queued.
  queuedBlockTime: BigInt!

  # Block timestamp at which this minipool was dequeued.
  dequeuedBlockTime: BigInt!

  # Block timestamp at which this minipool was destroyed.
  destroyedBlockTime: BigInt!

  # Block number at which this minipool transitioned to the staking state.
  stakingBlockTime: BigInt!

  # Block timestamp at which this minipool was marked as withdrawable.
  withdrawableBlockTime: BigInt!

  # Block timestamp at which this minipool was marked as finalized.
  finalizedBlockTime: BigInt!
}

type _RocketContract @entity {
  id: ID!
  keccak256: Bytes!
  latestAddress: Bytes!
  allAddresses: [Bytes!]!
}
