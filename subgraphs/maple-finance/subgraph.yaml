specVersion: 0.0.2
repository: https://github.com/messari/subgraphs
schema:
    file: ./schema.graphql
dataSources:
    - kind: ethereum/contract
      name: MapleGlobals
      network: mainnet
      source:
          address: "0xC234c62c8C09687DFf0d9047e40042cd166F3600"
          abi: MapleGlobals
          startBlock: 12428577
      mapping:
          kind: ethereum/events
          apiVersion: 0.0.5
          language: wasm/assemblyscript
          file: ./src/mappings/maple-globals.ts
          entities:
              - PoolFactory
              - LendingProtocol
          abis:
              - name: MapleGlobals
                file: ./abis/MapleGlobals.json
          eventHandlers:
              - event: GlobalsParamSet(indexed bytes32,uint256)
                handler: handleGlobalsParamSet
          callHandlers:
              - function: setValidPoolFactory(address,bool)
                handler: handleSetValidPoolFactory

    - kind: ethereum/contract
      name: MapleRewardsFactory
      network: mainnet
      source:
          address: "0x0155729EbCd47Cb1fBa02bF5a8DA20FaF3860535"
          abi: MapleRewardsFactory
          startBlock: 12428577
      mapping:
          kind: ethereum/events
          apiVersion: 0.0.5
          language: wasm/assemblyscript
          file: ./src/mappings/maple-rewards-factory.ts
          entities:
              - Market
              - RewardTokens
              - _MplReward
          abis:
              - name: MapleRewardsFactory
                file: ./abis/MapleRewardsFactory.json
              - name: ERC20
                file: ./abis/ERC20.json
              - name: ERC20NameBytes
                file: ./abis/ERC20NameBytes.json
              - name: ERC20SymbolBytes
                file: ./abis/ERC20SymbolBytes.json
          eventHandlers:
              - event: MplRewardsCreated(indexed address,indexed address,indexed address,address)
                handler: handleMplRewardsCreated

templates:
    - name: PoolFactory
      kind: ethereum/contract
      network: mainnet
      source:
          abi: PoolFactory
      mapping:
          kind: ethereum/events
          apiVersion: 0.0.5
          language: wasm/assemblyscript
          file: ./src/mappings/pool-factory.ts
          entities:
              - Market
              - _StakeLocker
          abis:
              - name: PoolFactory
                file: ./abis/PoolFactory.json
              - name: ERC20
                file: ./abis/ERC20.json
              - name: ERC20NameBytes
                file: ./abis/ERC20NameBytes.json
              - name: ERC20SymbolBytes
                file: ./abis/ERC20SymbolBytes.json
          eventHandlers:
              - event: PoolCreated(indexed address,indexed address,address,address,address,address,uint256,uint256,uint256,string,string)
                handler: handlePoolCreated

    - name: Pool
      kind: ethereum/contract
      network: mainnet
      source:
          abi: Pool
      mapping:
          kind: ethereum/events
          apiVersion: 0.0.5
          language: wasm/assemblyscript
          file: ./src/mappings/pool.ts
          entities:
              - Market
              - Deposit
              - Withdraw
              - _Loan
              - _StakeLocker
          abis:
              - name: Pool
                file: ./abis/Pool.json
              - name: Loan
                file: ./abis/Loan.json
              - name: ERC20
                file: ./abis/ERC20.json
              - name: ERC20NameBytes
                file: ./abis/ERC20NameBytes.json
              - name: ERC20SymbolBytes
                file: ./abis/ERC20SymbolBytes.json
          eventHandlers:
              - event: Transfer(indexed address,indexed address,uint256)
                handler: handleTransfer
              - event: PoolStateChanged(uint8)
                handler: handlePoolStateChanged
              - event: LoanFunded(indexed address,address,uint256)
                handler: handleLoanFunded
              - event: Claim(indexed address,uint256,uint256,uint256,uint256,uint256)
                handler: handleClaim
              - event: DefaultSuffered(indexed address,uint256,uint256,uint256,uint256)
                handler: handleDefaultSuffered
              - event: BalanceUpdated(indexed address,indexed address,uint256)
                handler: handleBalanceUpdated

    - name: StakeLocker
      kind: ethereum/contract
      network: mainnet
      source:
          abi: StakeLocker
      mapping:
          kind: ethereum/events
          apiVersion: 0.0.5
          language: wasm/assemblyscript
          file: ./src/mappings/stake-locker.ts
          entities:
              - _StakeLocker
              - Stake
              - Unstake
          abis:
              - name: StakeLocker
                file: ./abis/StakeLocker.json
              - name: ERC20
                file: ./abis/ERC20.json
              - name: ERC20NameBytes
                file: ./abis/ERC20NameBytes.json
              - name: ERC20SymbolBytes
                file: ./abis/ERC20SymbolBytes.json
          eventHandlers:
              - event: Stake(indexed address,uint256)
                handler: handleStake
              - event: Unstake(indexed address,uint256)
                handler: handleUnstake

    - name: Loan
      kind: ethereum/contract
      network: mainnet
      source:
          abi: Loan
      mapping:
          kind: ethereum/events
          apiVersion: 0.0.5
          language: wasm/assemblyscript
          file: ./src/mappings/loan.ts
          entities:
              - _Loan
              - Borrow
              - Repay
              - Liquidate
          abis:
              - name: Loan
                file: ./abis/Loan.json
              - name: ERC20
                file: ./abis/ERC20.json
              - name: ERC20NameBytes
                file: ./abis/ERC20NameBytes.json
              - name: ERC20SymbolBytes
                file: ./abis/ERC20SymbolBytes.json
          eventHandlers:
              - event: Drawdown(uint256)
                handler: handleDrawdown
              - event: PaymentMade(uint256,uint256,uint256,uint256,uint256,uint256,bool)
                handler: handlePaymentMade
              - event: Liquidation(uint256,uint256,uint256,uint256)
                handler: handleLiquidation

    - name: MplReward
      kind: ethereum/contract
      network: mainnet
      source:
          abi: MplReward
      mapping:
          kind: ethereum/events
          apiVersion: 0.0.5
          language: wasm/assemblyscript
          file: ./src/mappings/mpl-rewards.ts
          entities:
              - Market
              - _MplReward
              - Token
          abis:
              - name: MplReward
                file: ./abis/MplRewards.json
              - name: ERC20
                file: ./abis/ERC20.json
              - name: ERC20NameBytes
                file: ./abis/ERC20NameBytes.json
              - name: ERC20SymbolBytes
                file: ./abis/ERC20SymbolBytes.json
          eventHandlers:
              - event: Staked(indexed address,uint256)
                handler: handleStaked
              - event: Withdrawn(indexed address,uint256)
                handler: handleWidthdrawn
              - event: RewardAdded(uint256)
                handler: handleRewardAdded
              - event: RewardsDurationUpdated(uint256)
                handler: handleRewardsDurationUpdated
